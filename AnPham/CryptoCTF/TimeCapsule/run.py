c = 30263951492003430418944035844723976843761515320480688994488846431636782360488888188067655841720110193942081554547272176290791213962513701884837856823209432209367951673301622535940395295826053396595886942990258678430777333636450042181585837395671842878310404080487115827773100028876775230121509570227303374672524063165714509957850966189605469484201028704363052317830254920108664916139026741331552127849056897534960886647382429202269846392809641322613341548025760209280611758326300214885296175538901366986310471066687700879304860668964595202268317011117634615297226602309205086105573924029744405559823548638486054634428

n = 16801166465109052984956796702219479136700692152603640001472470493600002617002298302681832215942994746974878002533318970006820414971818787350153626339308150944829424332670924459749331062287393811934457789103209090873472485865328414154574392274611574654819495894137917800304580119452390318440601827273834522783696472257727329819952363099498446006266115011271978143149347765073211516486037823196033938908784720042927986421555211961923200006343296692217770693318701970436618066568854673260978968978974409802211538011638213976732286150311971354861300195440286582255769421094876667270445809991401456443444265323573485901383

t = 6039738711082505929

z = 13991757597132156574040593242062545731003627107933800388678432418251474177745394167528325524552592875014173967690166427876430087295180152485599151947856471802414472083299904768768434074446565880773029215057131908495627123103779932128807797869164409662146821626628200600678966223382354752280901657213357146668056525234446747959642220954294230018094612469738051942026463767172625588865125393400027831917763819584423585903587577154729283694206436985549513217882666427997109549686825235958909428605247221998366006018410026392446064720747424287400728961283471932279824049509228058334419865822774654587977497006575152095818

def encrypt_time_capsule(msg, n, t, z):
	m = bytes_to_long(msg)
	l = pow(2, pow(2, t), n)
	c = l ^ z ^ m
	return (c, n, t, z)

def decodeMsg(msg):
    msg = hex(msg)
    if msg[:2] == '0x': msg = msg[2:]
    if msg[-1] == 'L': msg = msg[:-1]
    return msg
    return msg.decode('hex')

def decrypt_time_capsule(c, n, phi, t, z):
	l = pow(2, pow(2, t, phi), n)
	m = l ^ z ^ c
	return decodeMsg(m)

a = 1119107870852531338503749863599512365063657640218719776292044927303004237461020335887686153063544577830871777961321452741412137145928114790525119985299950106229895712560509189352516556470218731228565762279571643966793611261262133761045386816399891737482148530882429747572409253277319011419476575452863153452587522297857012577096673756044657697080271432176911885908835526881583395489644829360956100640030954508954105536638594015981029774618217324466646952196010255807408117402841182525876171916270859242137583295253328047474341314215144964688023725800325490059000161266560758494001585958262935885129172405486810491
b = 15013

phi = (a-1)*(b-1)

print decrypt_time_capsule(c, n, phi, t, z)
